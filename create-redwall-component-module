#!/bin/bash

printf "Welcome to \e[91mCreate Redwall Component Module\e[0m \e[1m(CRCM)\e[0m";
printf "\nPlease, what's the project name?\n\e[91m"
read PROJECTNAME
printf "\e[0mNice. Now, what's the remote \e[1mgit repository URL\e[0m of it?\n\e[91m"
read PROJECTREPO
printf "\e[0m\e[1mGreat! \e[0mLet's create the environment component module structure.\n\e[0m"

PROJECTFOLDER=/home/$USER/Development/
mkdir -p $PROJECTFOLDER
PROJECTFOLDER=/home/$USER/Development/$PROJECTNAME

yarn create react-app $PROJECTFOLDER --typescript

clear
cd $PROJECTFOLDER
rm src/*
printf "Downloading contents to create a new \e[91m\e[5mRedwall Component Module.\e[0m\n"
curl -s -o src/index.js https://github.com/redwallsolutions/create-redwall-component-module/blob/master/index.js
mkdir src/lib
mkdir -p src/lib/{components,assets}
curl -s -o src/lib/components/Style.js https://github.com/redwallsolutions/create-redwall-component-module/blob/master/Style.js
rm package.json
curl -s -o package.json https://github.com/redwallsolutions/create-redwall-component-module/blob/master/package.json
sed -i "s/{{projectname}}/$PROJECTNAME/" package.json
sed -i "s/{{projectrepo}}/$PROJECTREPO/" package.json
curl -s -o .npmrc https://github.com/redwallsolutions/create-redwall-component-module/blob/master/.npmrc

yarn install --silent --update-checksums

echo '{ "presets": [["react-app", { "absoluteRuntime": false }]] }' > .babelrc
echo '{ "extends": "react-app" }' > .eslintrc

echo "# $PROJECTNAME  " > README.md

git init
git add .
git commit -m "First commit created by CRCM."
git remote add origin $PROJECTREPO

printf "\n\n\e[1mDONE! \e[0mLet's start coding.\n\nTry to copy and paste the following command...\n\n\e[94m\e[1mcd ${PROJECTFOLDER} && yarn start\n\e[0m"
