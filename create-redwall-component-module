#!/bin/bash

printf "Welcome to \e[91mCreate Redwall Component Module\e[0m \e[1m(CRCM)\e[0m";
printf "\nPlease, what's the project name?\n\e[91m"
read PROJECTNAME
PROJECTREPO="https://github.com/redwallsolutions/$PROJECTNAME"
printf "\e[0m\e[1mGreat! \e[0mLet's create the environment component module structure.\n\e[0m"

PROJECTFOLDER=/home/$USER/Development/
mkdir -p $PROJECTFOLDER
PROJECTFOLDER=$PROJECTFOLDER$PROJECTNAME

yarn create react-app $PROJECTFOLDER --typescript

rm $PROJECTFOLDER/src/*
printf "Downloading contents to create a new \e[91m\e[5mRedwall Component Module.\e[0m\n"
curl -s -o $PROJECTFOLDER/src/index.js https://raw.githubusercontent.com/redwallsolutions/create-redwall-component-module/master/index.js
mkdir $PROJECTFOLDER/src/lib
mkdir -p $PROJECTFOLDER/src/lib/{components,assets}
curl -s -o $PROJECTFOLDER/src/lib/components/Style.js https://raw.githubusercontent.com/redwallsolutions/create-redwall-component-module/master/Style.js
rm $PROJECTFOLDER/package.json
curl -s -o $PROJECTFOLDER/package.json https://raw.githubusercontent.com/redwallsolutions/create-redwall-component-module/master/package.json
sed -i "s/{{projectname}}/$PROJECTNAME/" $PROJECTFOLDER/package.json
sed -i "s/{{projectrepo}}/https:\/\/github.com\/redwallsolutions\/$PROJECTNAME/" $PROJECTFOLDER/package.json
curl -s -o $PROJECTFOLDER/.npmrc https://raw.githubusercontent.com/redwallsolutions/create-redwall-component-module/master/.npmrc

cd $PROJECTFOLDER

yarn install --silent --update-checksums

echo '{ "presets": [["react-app", { "absoluteRuntime": false }]] }' > .babelrc
echo '{ "extends": "react-app" }' > .eslintrc

echo "# $PROJECTNAME  " > README.md

git init
git add .
git commit -m "First commit created by CRCM."
git remote add origin $PROJECTREPO

printf "\n\n\e[1mDONE! \e[0mLet's start coding.\n\nTry to copy and paste the following command...\n\n\e[94m\e[1mcd ${PROJECTFOLDER} && yarn start\n\e[0m"
